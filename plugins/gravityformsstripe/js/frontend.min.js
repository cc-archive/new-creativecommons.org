window.GFStripe=null,function(a){GFStripe=function(b){for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c]);this.form=null,this.init=function(){if(this.isCreditCardOnPage()){var b=this;Stripe.setPublishableKey(this.apiKey),this.isAjax||gformInitSpinner(this.formId),a("#gform_"+this.formId).submit(function(c){if(!a(this).data("gfstripesubmitting")&&1!=a("#gform_save_"+b.formId).val()){c.preventDefault(),a(this).data("gfstripesubmitting",!0);var d=a(this),e="input_"+b.formId+"_"+b.ccFieldId+"_",f={number:d.find("#"+e+"1").val(),exp_month:d.find("#"+e+"2_month").val(),exp_year:d.find("#"+e+"2_year").val(),cvc:d.find("#"+e+"3").val(),name:d.find("#"+e+"5").val()};b.form=d,Stripe.card.createToken(f,function(a,c){b.responseHandler(a,c)})}})}},this.responseHandler=function(b,c){for(var d=this.form,e="input_"+this.formId+"_"+this.ccFieldId+"_",f=["1","2_month","2_year","3","5"],g=!1,h=0;h<f.length;h++){var i=d.find("#"+e+f[h]);if("1"==f[h]){var j=a.trim(i.val()),g=gformFindCardType(j);"undefined"!=typeof this.cardLabels[g]&&(g=this.cardLabels[g]),d.append(a('<input type="hidden" name="stripe_credit_card_last_four" />').val(j.slice(-4))),d.append(a('<input type="hidden" name="stripe_credit_card_type" />').val(g))}}d.append(a('<input type="hidden" name="stripe_response" />').val(a.toJSON(c))),d.submit()},this.isLastPage=function(){var b=a("#gform_target_page_number_"+this.formId);return b.length>0?0==b.val():!0},this.isCreditCardOnPage=function(){var a=this.getCurrentPageNumber();return this.ccPage&&a?this.ccPage==a:!0},this.getCurrentPageNumber=function(){var b=a("#gform_source_page_number_"+this.formId);return b.length>0?b.val():!1},this.init()}}(jQuery);